<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Smart Mirror Senior Design 2: Simple Skin Lesion Localization | austinpursley.com</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="Smart Mirror Senior Design 2: Simple Skin Lesion Localization" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="The senior design project I have been working on in school is a “smart mirror”. Equipped with a thermal and RGB camera, its primary goal is to analyze a user’s face and give health feedback. The subsystem I was responsible for was image processing and my goal was to analyze the images to obtain health metrics. In this post, I go over analyzing skin images to locate lesions." />
<meta property="og:description" content="The senior design project I have been working on in school is a “smart mirror”. Equipped with a thermal and RGB camera, its primary goal is to analyze a user’s face and give health feedback. The subsystem I was responsible for was image processing and my goal was to analyze the images to obtain health metrics. In this post, I go over analyzing skin images to locate lesions." />
<link rel="canonical" href="http://localhost:4000/projects/image_processing_lesion_localize_simple.html" />
<meta property="og:url" content="http://localhost:4000/projects/image_processing_lesion_localize_simple.html" />
<meta property="og:site_name" content="austinpursley.com" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-01-27T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Smart Mirror Senior Design 2: Simple Skin Lesion Localization" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2018-01-27T00:00:00-05:00","datePublished":"2018-01-27T00:00:00-05:00","description":"The senior design project I have been working on in school is a “smart mirror”. Equipped with a thermal and RGB camera, its primary goal is to analyze a user’s face and give health feedback. The subsystem I was responsible for was image processing and my goal was to analyze the images to obtain health metrics. In this post, I go over analyzing skin images to locate lesions.","headline":"Smart Mirror Senior Design 2: Simple Skin Lesion Localization","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/projects/image_processing_lesion_localize_simple.html"},"url":"http://localhost:4000/projects/image_processing_lesion_localize_simple.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/styles.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="austinpursley.com" /></head>
<body>
    <main class="page-content" aria-label="Content">
	
      <div class="wrapper project">
	
        <h1>Smart Mirror Senior Design 2: Simple Skin Lesion Localization</h1>
<p>27 Jan 2018</p>

<p>The senior design project I have been working on in school is a “smart mirror”. 
 Equipped with a thermal and RGB camera, its primary goal is to analyze a user’s face and give health feedback. 
 The subsystem I was responsible for was image processing and
 my goal was to analyze the images to obtain health metrics.
 In this post, I go over analyzing skin images to locate lesions.</p>

<p><img src="/assets/images/acne.webp" alt="fever" />
<em>Many people have acne and other skim blemishes they may be self-conscious of. The smart mirror can help with that. Be more self-conscious, that is.</em></p>

<h2 id="skin-lesions">Skin Lesions</h2>

<p>Skin lesions are areas of the skin that are abnormal in appearance, such as acne and moles. Being able to locate skin lesions would give a metric for our smart mirror to track skin health over time.</p>

<h2 id="process">Process</h2>

<p><img src="/assets/images/lesion_localize_simple_diagram.webp" alt="flow diagram" />
<em>Diagram for the process of localizing skin lesions.</em></p>

<p>The process is inspired by a paper,
 <a href="https://www.spiedigitallibrary.org/conference-proceedings-of-spie/9785/97850B/Acne-image-analysis-lesion-localization-and-classification/10.1117/12.2216444.full?SSO=1">“Acne image analysis: lesion localization and classification”</a> 
 .</p>

<p>An assumption of this process is that the input image is just skin and has
 already been extracted. The first step is to convert the image from BGR to
 <a href="https://en.wikipedia.org/wiki/Lab_color_space#CIELAB">CIE L*a*b*</a> 
 color space. Then three channels are mixed into one using weights that were found experimentally.</p>

<p>A guassian blur and adaptive thresholding is then applied. Why adaptive thresholding? Thresholding like Otsu’s method considers the entire image when choosing a threshold value, but does not work particularly well here because of uneven lighting conditions. Adaptive thresholding applies different thresholds for different regions of the image based on the local conditions of that region.</p>

<p>We are left with a binary image, white areas being the “blobs” that could be lesions. However, some will be too small or clumped together, so we apply open and erosion morphological transformations to filter them out.</p>

<p>Finally, we find contours (vectors of points that outline region-of-interest) of the blobs and filter those further by discarding those that are still too small or too elongated. All the contours left over should then correspond to skin lesions.</p>

<h2 id="parameters">Parameters</h2>

<p>There are parameters that should be adjusted depending on how dimension of the image and lesion size. These are: gaussian filter k-size, adaptive threshold block size, size of the morphological elements, and the minimum and maximum contour area. These parameters change if the image is large or if the lesions take up a large area of the image. You could apply several rounds of this process to detect a wider range of lesion sizes.</p>

<p>The weights of the channel mixing are parameters that can affect what kinds of blobs are detected. You can experiment with other color spaces and combinations of channels to detect different kinds of lesions. For example the Cr channel of the YCrCb color space does a pretty good job of detecting red lesions.</p>

<h2 id="corner-cases">Corner Cases</h2>

<p>This particular case is suppose to catch skin lesions that are darker than the surrounding skin. However, there are cases where the skin lesions are lighter than the surrounding skin. A reverse process could theoretically be applied where the same process is applied to an inverted image, but I never got around to experimenting with that.</p>

<p>This process also works less well when a flash had been used when taking the image. The bright white light reflects off the skin and obscures skin details like lesions. Ideally, images of the skin are taken in uniform lighting with no flash.</p>

<p><a href="https://github.com/austinpursley/ECEN-Senior-Design-Smart-Mirror-Image-Processing/tree/master/rgb">Github</a> 
 , which includes C++, OpenCV code and example output results for several skin images.</p>



      </div>
    </main>
  </body>

</html>
